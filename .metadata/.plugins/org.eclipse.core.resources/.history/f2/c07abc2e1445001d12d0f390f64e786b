package com.webDataProject.webData;

import java.util.List;
import java.util.Date;


import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;
import com.webDataProject.webData.PriceRepository;
import com.webDataProject.webData.IncomeStatementRepository;
import org.springframework.web.bind.annotation.PathVariable;
@Controller
@RequestMapping("/api")
public class LandingController {
	@Autowired // This means to get the bean called priceRepository Which is auto-generated by Spring, 
				// we will use it to handle the data
	private PriceRepository priceRepository;
	private IncomeStatementRepository incomeStatementRepository;
	@GetMapping("/index")
	public String greeting() {
		return "index";
	}
	@GetMapping("/stocks/all")
  	public @ResponseBody Iterable<Price> getAllUsers() {
	  // This returns a JSON or XML with the users
	  return priceRepository.findAll();
    }
	
	@GetMapping("/stocks/{ticker}")
	public @ResponseBody List<Price> getDataByTicker(@PathVariable String ticker) {
	     return priceRepository.findByTicker(ticker);
	}
	@GetMapping("/stocks/date/{day}")
	public @ResponseBody List<Price> getDataByDay(@PathVariable String day) {
	    return priceRepository.findByDate(day);
	}
	@GetMapping("/stocks/{ticker}/{day}")
	public @ResponseBody List<Price> getDataByDay(@PathVariable String day, @PathVariable String ticker) {
	    return priceRepository.findByDateAndTicker(day, ticker);
	}
	@GetMapping("/stocks/{ticker}/{startDate}/{endDate}")
	// Mapping wants dates in yyyy-mm-dd format
	public @ResponseBody List<Price> getTickerSpecificData(@PathVariable String ticker, @PathVariable String startDate, @PathVariable String endDate){
		return priceRepository.getAllBetweenDatesAndTicker(ticker, startDate, endDate);
	}
   @GetMapping("/stocks/incomeStatements/all")
    public @ResponseBody Iterable<IncomeStatement> getAllUsers() {
      // This returns a JSON or XML with the users
      return priceRepository.findAll();
    }
    
    @GetMapping("/stocks/incomeStatements/{ticker}")
    public @ResponseBody List<IncomeStatement> getIncomeStatementsByTicker(@PathVariable String ticker) {
         return incomeStatementRepository.findByTicker(ticker);
    }
    @GetMapping("/stocks/incomeStatements/date/{day}")
    public @ResponseBody List<IncomeStatement> getIncomeStatementsByDay(@PathVariable String day) {
        return incomeStatementRepository.findByDate(day);
    }
    @GetMapping("/stocks/incomeStatements/{ticker}/{day}")
    public @ResponseBody List<IncomeStatement> getIncomeStatementsByDay(@PathVariable String day, @PathVariable String ticker) {
        return incomeStatementRepository.findByDateAndTicker(day, ticker);
    }
}